vec1 and vec2 are reused
